var e=Object.defineProperty,a=Object.defineProperties,r=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,n=(a,r,t)=>r in a?e(a,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[r]=t,s=(e,a,r)=>new Promise(((t,o)=>{var l=e=>{try{s(r.next(e))}catch(a){o(a)}},n=e=>{try{s(r.throw(e))}catch(a){o(a)}},s=e=>e.done?t(e.value):Promise.resolve(e.value).then(l,n);s((r=r.apply(e,a)).next())}));import{c as u,a as c,b as i,F as m,p as d,t as p,B as f,m as v,n as h,q as y,s as b,r as g,u as P,x as C,z as I,y as D,o as k}from"./vue-vendor-sc64KA4g.js";import{u as w}from"./lottery-core-BVADiGTv.js";import{_ as O}from"./index-Cryigixn.js";const j={class:"checkout"},V={class:"checkout-container"},_={class:"selected-numbers-section"},x={class:"numbers-grid"},E={class:"lottery-details"},N={class:"lottery-number"},R={class:"lottery-type"},S={class:"draw-date"},A=["onClick"],F={class:"total-amount"},L={class:"checkout-form-section"},T={class:"form-group"},q={class:"form-group"},M={class:"phone-input"},U={class:"form-group"},B={class:"phone-input"},H={class:"form-group"},$={key:0,class:"error-message"},z=["disabled"],Y={class:"more-lottery-section"};const Z=O({name:"Checkout",setup(){const e=I(),u=w();let c;const i=g(""),m=g(""),d=g(!1),p=g({name:"",phone:"",confirmPhone:"",referralCode:""}),f=P((()=>u.cartItems.reduce(((e,a)=>e+parseInt(a.amount)),0))),v=P((()=>p.value.name&&p.value.phone&&p.value.confirmPhone&&p.value.phone===p.value.confirmPhone&&!i.value));return C((()=>{c=setInterval((()=>{u.refreshLotteryList(),0===u.cartItems.length&&e.push("/")}),2e3)})),D((()=>{c&&clearInterval(c)})),{store:u,formData:p,totalAmount:f,handleSubmit:()=>s(this,null,(function*(){try{s=((e,a)=>{for(var r in a||(a={}))o.call(a,r)&&n(e,r,a[r]);if(t)for(var r of t(a))l.call(a,r)&&n(e,r,a[r]);return e})({amount:f.value,currency:"Nu.",receipt:`receipt_${Date.now()}`},p.value),c={tickets:u.cartItems},a(s,r(c));alert("Order placed successfully!"),u.clearCart(),e.push("/")}catch(i){alert("Order failed. Please try again.")}var s,c})),goBack:()=>{e.push("/")},removeItem:a=>{u.removeFromCart(a),0===u.cartItems.length&&e.push("/")},phoneError:i,validatePhone:()=>{const e=p.value.phone,a=p.value.confirmPhone;e&&a&&e!==a?i.value="Phone numbers do not match":e&&!/^[0-9]{8}$/.test(e)?i.value="Phone number must be 8 digits":i.value=""},isFormValid:v,referralMessage:m,isValidReferral:d,validateReferralCode:()=>s(this,null,(function*(){const e=p.value.referralCode.trim();if(!e)return m.value="",void(d.value=!1);try{6===e.length&&/^[A-Z0-9]+$/.test(e)?(m.value="Valid referral code!",d.value=!0):(m.value="Invalid referral code format",d.value=!1)}catch(a){m.value="Error validating referral code",d.value=!1}})),goToHome:()=>{e.push("/")}}}},[["render",function(e,a,r,t,o,l){return k(),u("div",j,[c("div",V,[c("div",_,[a[12]||(a[12]=c("h3",null,"Your Total Lottery",-1)),a[13]||(a[13]=i()),c("div",x,[(k(!0),u(m,null,d(t.store.cartItems,(e=>(k(),u("div",{key:e.lottery_no,class:"number-item"},[c("div",E,[c("span",N,p(e.lottery_no),1),a[9]||(a[9]=i()),c("span",R,p(e.lottery_type),1),a[10]||(a[10]=i()),c("span",S,"Draw: "+p(new Date(e.draw_date).toLocaleDateString()),1)]),a[11]||(a[11]=i()),c("button",{class:"remove-btn",onClick:a=>t.removeItem(e)},"Ã—",8,A)])))),128))]),a[14]||(a[14]=i()),c("div",F,"\r\n          Total Amount: Nu. "+p(t.totalAmount),1)]),a[35]||(a[35]=i()),c("div",L,[a[33]||(a[33]=c("h3",null,"Checkout Details",-1)),a[34]||(a[34]=i()),c("form",{onSubmit:a[7]||(a[7]=f(((...e)=>t.handleSubmit&&t.handleSubmit(...e)),["prevent"])),class:"checkout-form"},[c("div",T,[a[15]||(a[15]=c("label",{for:"name"},"Full Name *",-1)),a[16]||(a[16]=i()),h(c("input",{type:"text",id:"name","onUpdate:modelValue":a[0]||(a[0]=e=>t.formData.name=e),required:"",autocomplete:"off"},null,512),[[y,t.formData.name]])]),a[28]||(a[28]=i()),c("div",q,[a[19]||(a[19]=c("label",{for:"phone"},"Phone Number *",-1)),a[20]||(a[20]=i()),c("div",M,[a[17]||(a[17]=c("span",{class:"country-code"},"+975",-1)),a[18]||(a[18]=i()),h(c("input",{type:"tel",id:"phone","onUpdate:modelValue":a[1]||(a[1]=e=>t.formData.phone=e),pattern:"[0-9]{8}",required:"",autocomplete:"off",placeholder:"Enter 8 digit number",onInput:a[2]||(a[2]=(...e)=>t.validatePhone&&t.validatePhone(...e))},null,544),[[y,t.formData.phone]])])]),a[29]||(a[29]=i()),c("div",U,[a[23]||(a[23]=c("label",{for:"confirmPhone"},"Confirm Phone Number *",-1)),a[24]||(a[24]=i()),c("div",B,[a[21]||(a[21]=c("span",{class:"country-code"},"+975",-1)),a[22]||(a[22]=i()),h(c("input",{type:"tel",id:"confirmPhone","onUpdate:modelValue":a[3]||(a[3]=e=>t.formData.confirmPhone=e),pattern:"[0-9]{8}",required:"",autocomplete:"off",placeholder:"Re-enter phone number",onInput:a[4]||(a[4]=(...e)=>t.validatePhone&&t.validatePhone(...e))},null,544),[[y,t.formData.confirmPhone]])])]),a[30]||(a[30]=i()),c("div",H,[a[25]||(a[25]=c("label",{for:"referralCode"},"Referral Code (Optional)",-1)),a[26]||(a[26]=i()),h(c("input",{type:"text",id:"referralCode","onUpdate:modelValue":a[5]||(a[5]=e=>t.formData.referralCode=e),autocomplete:"off",placeholder:"Enter referral code if you have one",onInput:a[6]||(a[6]=(...e)=>t.validateReferralCode&&t.validateReferralCode(...e))},null,544),[[y,t.formData.referralCode]]),a[27]||(a[27]=i()),c("p",{class:b(["referral-message",{valid:t.isValidReferral,invalid:t.referralMessage.includes("Invalid")}])},p(t.referralMessage),3)]),a[31]||(a[31]=i()),t.phoneError?(k(),u("p",$,p(t.phoneError),1)):v("",!0),a[32]||(a[32]=i()),c("button",{type:"submit",class:"pay-button",disabled:!t.isFormValid},"\r\n            Pay Now Nu. "+p(t.totalAmount),9,z)],32)])]),a[37]||(a[37]=i()),c("div",Y,[c("button",{onClick:a[8]||(a[8]=(...e)=>t.goToHome&&t.goToHome(...e)),class:"more-lottery-btn"},a[36]||(a[36]=[c("i",{class:"fas fa-ticket-alt"},null,-1),i("\r\n        Browse More Lottery\r\n        "),c("i",{class:"fas fa-arrow-right"},null,-1)]))])])}],["__scopeId","data-v-35b1816f"]]);export{Z as default};
