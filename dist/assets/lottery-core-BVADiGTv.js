var t=Object.defineProperty,e=Object.defineProperties,r=Object.getOwnPropertyDescriptors,s=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,a=(e,r,s)=>r in e?t(e,r,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[r]=s,n=(t,e,r)=>new Promise(((s,o)=>{var i=t=>{try{n(r.next(t))}catch(e){o(e)}},a=t=>{try{n(r.throw(t))}catch(e){o(e)}},n=t=>t.done?s(t.value):Promise.resolve(t.value).then(i,a);n((r=r.apply(t,e)).next())}));import{d as l,r as c}from"./vue-vendor-sc64KA4g.js";const m=l("lottery",{state:()=>({lotteryNumbers:c([]),error:c(null),isLoading:c(!1),lastFetchTime:c(null),cartItems:c([]),lastUpdateTime:c(null),selectedLotteryType:c(null),filteredLotteryNumbers:c([]),currentLotteryType:c(null),types:[],upcomingDraws:[],results:[],favoriteNumbers:[],subscriptions:[]}),getters:{uniqueLotteryTypes:t=>{const e=t.lotteryNumbers.map((t=>({id:t.iLotteryTypeId,name:t.lottery_name})));return[...new Map(e.map((t=>[t.id,t]))).values()]},getUpcomingDraws:t=>t.upcomingDraws,getFavoriteNumbers:t=>t.favoriteNumbers},actions:{fetchLotteryList(){return n(this,null,(function*(){const t=new AbortController,e=setTimeout((()=>t.abort()),3e4);if(!(this.lastFetchTime&&Date.now()-this.lastFetchTime<3e5)){this.isLoading=!0;try{const r=yield fetch("https://lottery.indob2c.com//ticket.php",{method:"GET",mode:"cors",headers:{Accept:"application/json"},signal:t.signal});if(clearTimeout(e),!r.ok)throw new Error(`HTTP error! status: ${r.status}`);const s=yield r.json();if(!Array.isArray(s))throw new Error("Invalid data format received");this.lotteryNumbers=s,this.lastFetchTime=Date.now(),this.error=null}catch(r){"AbortError"===r.name?this.error="Request timed out. Please try again.":this.error="Unable to load lottery numbers. Please try again later.",this.lotteryNumbers=[]}finally{this.isLoading=!1,clearTimeout(e)}}}))},refreshLotteryList(){return n(this,null,(function*(){try{const t=yield fetch("https://lottery.indob2c.com//ticket.php",{method:"GET",mode:"cors",headers:{Accept:"application/json"}});if(!t.ok)return;const e=yield t.json();Array.isArray(e)&&(this.lotteryNumbers=e,this.lastUpdateTime=Date.now(),this.cartItems=this.cartItems.filter((t=>e.some((e=>e.lottery_no===t.lottery_no)))),sessionStorage.setItem("cartItems",JSON.stringify(this.cartItems)))}catch(t){}}))},fetchLotteryByType(t=""){return n(this,null,(function*(){this.isLoading=!0;try{const e=t?`https://lottery.indob2c.com//ticket.php?lottery_type=${t}`:"https://lottery.indob2c.com//ticket.php",r=yield fetch(e,{method:"GET",mode:"cors",headers:{Accept:"application/json"}});if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);const s=yield r.json();Array.isArray(s)&&(this.lotteryNumbers=s,this.filteredLotteryNumbers=s,this.lastUpdateTime=Date.now())}catch(e){this.error="Unable to load lottery numbers. Please try again later."}finally{this.isLoading=!1}}))},addToCart(t){if(!this.cartItems.some((e=>e.lottery_no===t.lottery_no))){const c=(n=((t,e)=>{for(var r in e||(e={}))o.call(e,r)&&a(t,r,e[r]);if(s)for(var r of s(e))i.call(e,r)&&a(t,r,e[r]);return t})({},t),l={lottery_id:t.iLotteryId||Date.now(),lottery_type:t.lottery_name,draw_date:t.draw_date,amount:parseInt(t.amount),added_at:(new Date).toISOString()},e(n,r(l)));this.cartItems.push(c),sessionStorage.setItem("cartItems",JSON.stringify(this.cartItems))}var n,l},removeFromCart(t){this.cartItems=this.cartItems.filter((e=>e.lottery_no!==t.lottery_no)),sessionStorage.setItem("cartItems",JSON.stringify(this.cartItems))},clearCart(){this.cartItems=[],sessionStorage.removeItem("cartItems")},loadCartFromSession(){const t=sessionStorage.getItem("cartItems");t&&(this.cartItems=JSON.parse(t))},filterByType(t){return this.currentLotteryType=t,t?this.lotteryNumbers.filter((e=>e.iLotteryTypeId===parseInt(t))):this.lotteryNumbers},fetchLotteryTypes(){return n(this,null,(function*(){}))},purchaseTicket(t){return n(this,null,(function*(){}))},subscribeToDraw(t,e){return n(this,null,(function*(){this.subscriptions.push({drawId:t,numbers:e,autoRenew:!0})}))},addToFavorites(t){this.favoriteNumbers.includes(t)||this.favoriteNumbers.push(t)},generateRandomNumbers:t=>Array.from({length:t},(()=>Math.floor(99999*Math.random())+1))}});export{m as u};
