var e=(e,t,s)=>new Promise(((o,r)=>{var a=e=>{try{n(s.next(e))}catch(t){r(t)}},l=e=>{try{n(s.throw(e))}catch(t){r(t)}},n=e=>e.done?o(e.value):Promise.resolve(e.value).then(a,l);n((s=s.apply(e,t)).next())}));import{u as t}from"./lottery-core-BVADiGTv.js";import{c as s,a as o,b as r,m as a,n as l,v as n,F as c,p as y,q as u,t as i,s as d,r as p,u as h,x as m,y as v,z as T,o as L}from"./vue-vendor-sc64KA4g.js";import{_ as g}from"./index-Cryigixn.js";const f={class:"home"},k={class:"search-container"},C=["value"],b={class:"search-box"},I={key:0,class:"cart-preview"},_={key:1,class:"loading"},x={key:2,class:"error"},w={key:3,class:"no-results"},S={key:4,class:"lottery-grid"},N=["onClick"],B={class:"lottery-inner"},P={class:"lottery-number"},Q={class:"lottery-details"},j={class:"lottery-name"},q={class:"lottery-price"},F={class:"cart-text"};const R=g({name:"Home",setup(){const s=t(),o=T(),r=p(""),a=p(!1),l=p(""),n=p("success"),c=p("");let y;const u=(e,t="success")=>{l.value=e,n.value=t,a.value=!0,setTimeout((()=>{a.value=!1}),2e3)},i=h((()=>{let e=c.value?s.filterByType(c.value):s.lotteryNumbers;return r.value?e.filter((e=>e.lottery_no.toLowerCase().includes(r.value.toLowerCase()))):e})),d=e=>s.cartItems.some((t=>t.lottery_no===e.lottery_no));h((()=>s.cartItems.reduce(((e,t)=>e+parseInt(t.amount)),0)));const L=h((()=>s.lotteryNumbers.reduce(((e,t)=>(e.some((e=>e.iLotteryTypeId===t.iLotteryTypeId))||e.push({iLotteryTypeId:t.iLotteryTypeId,lottery_name:t.lottery_name}),e)),[])));return m((()=>e(this,null,(function*(){s.loadCartFromSession(),yield s.fetchLotteryByType(),y=setInterval((()=>{s.refreshLotteryList()}),2e3)})))),v((()=>{y&&clearInterval(y)})),{store:s,searchQuery:r,filteredResults:i,isSelected:d,toggleSelection:e=>{d(e)?(s.removeFromCart(e),u("Lottery removed from cart","error")):(s.addToCart(e),u(`Lottery added to cart - Nu.${e.amount}`))},goToCheckout:()=>{o.push("/checkout")},showToast:a,toastMessage:l,toastType:n,selectedType:c,uniqueLotteryTypes:L,handleTypeChange:()=>e(this,null,(function*(){r.value="",yield s.fetchLotteryByType(c.value)}))}}},[["render",function(e,t,p,h,m,v){return L(),s("div",f,[t[14]||(t[14]=o("div",{class:"hero-section"},[o("h1",null,"Welcome to Bhutan Lottery"),r(),o("p",{class:"subtitle"},"Choose your lucky numbers and win big prizes!")],-1)),t[15]||(t[15]=r()),o("div",k,[l(o("select",{"onUpdate:modelValue":t[0]||(t[0]=e=>h.selectedType=e),class:"form-select",onChange:t[1]||(t[1]=(...e)=>h.handleTypeChange&&h.handleTypeChange(...e))},[t[4]||(t[4]=o("option",{value:""},"All Lottery Types",-1)),t[5]||(t[5]=r()),(L(!0),s(c,null,y(h.uniqueLotteryTypes,(e=>(L(),s("option",{key:e.iLotteryTypeId,value:e.iLotteryTypeId},i(e.lottery_name),9,C)))),128))],544),[[n,h.selectedType]]),t[8]||(t[8]=r()),o("div",b,[t[6]||(t[6]=o("i",{class:"fas fa-search search-icon"},null,-1)),t[7]||(t[7]=r()),l(o("input",{type:"text","onUpdate:modelValue":t[2]||(t[2]=e=>h.searchQuery=e),placeholder:"Search By Lottery Number...",class:"form-select"},null,512),[[u,h.searchQuery]])])]),t[16]||(t[16]=r()),h.store.cartItems.length?(L(),s("div",I,[o("h3",null,"Total Lottery: "+i(h.store.cartItems.length),1),t[9]||(t[9]=r()),o("button",{onClick:t[3]||(t[3]=(...e)=>h.goToCheckout&&h.goToCheckout(...e)),class:"checkout-btn"},"Proceed to Payment")])):a("",!0),t[17]||(t[17]=r()),h.store.isLoading?(L(),s("div",_,t[10]||(t[10]=[o("div",{class:"spinner"},null,-1),r(),o("p",null,"Loading lottery numbers...",-1)]))):h.store.error?(L(),s("div",x,i(h.store.error),1)):0===h.filteredResults.length&&h.searchQuery?(L(),s("div",w,"\r\n      This Lottery Number is not Available\r\n    ")):(L(),s("div",S,[(L(!0),s(c,null,y(h.filteredResults,(e=>(L(),s("div",{key:e.id,class:d(["lottery-box",{selected:h.isSelected(e)}]),onClick:t=>h.toggleSelection(e)},[o("div",B,[o("span",P,i(e.lottery_no),1),t[12]||(t[12]=r()),o("div",Q,[o("span",j,i(e.lottery_name),1),t[11]||(t[11]=r()),o("span",q,"Nu."+i(e.amount),1)]),t[13]||(t[13]=r()),o("span",F,i((h.isSelected(e),"")),1)])],10,N)))),128))])),t[18]||(t[18]=r()),h.showToast?(L(),s("div",{key:5,class:d(["toast",h.toastType])},i(h.toastMessage),3)):a("",!0)])}],["__scopeId","data-v-49c69d8e"]]);export{R as default};
